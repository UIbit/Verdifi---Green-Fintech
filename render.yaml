services:
  - type: web
    name: node-carbon-dashboard
    env: node
    buildCommand: find . -name "package.json" -type f | head -1 | xargs dirname | xargs -I {} sh -c "cd {} && npm install"
    startCommand: find . -name "package.json" -type f | head -1 | xargs dirname | xargs -I {} sh -c "cd {} && npm run dashboard"
    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        fromService:
          type: web
          name: node-carbon-dashboard
          property: port
      - key: ALLOWED_ORIGINS
        sync: false
